var loremText = [
    "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Maecenas varius tortor nibh, sit amet tempor nibh finibus et. Aenean eu enim justo. Vestibulum aliquam hendrerit molestie. Mauris malesuada nisi sit amet augue accumsan tincidunt. Maecenas tincidunt, velit ac porttitor pulvinar, tortor eros facilisis libero, vitae commodo nunc quam et ligula. Ut nec ipsum sapien. Interdum et malesuada fames ac ante ipsum primis in faucibus. Integer id nisi nec nulla luctus lacinia non eu turpis. Etiam in ex imperdiet justo tincidunt egestas. Ut porttitor urna ac augue cursus tincidunt sit amet sed orci.",
    "Donec libero turpis, lacinia nec leo sit amet, dignissim dignissim lacus. Nunc semper, leo vel bibendum dapibus, justo lectus dapibus libero, vitae volutpat mi justo eget sem. Curabitur sagittis, dui vitae accumsan dictum, leo metus lobortis leo, ut sagittis lorem sem eu elit. Nulla facilisi. Mauris imperdiet diam ac maximus auctor. Donec sed nisl nibh. Nunc est nibh, porttitor sit amet metus vitae, suscipit convallis nisl. Pellentesque non fringilla enim, at luctus quam. Quisque vitae magna molestie, faucibus nunc eget, rutrum elit. Nulla euismod metus sem. Donec in vulputate ex. Maecenas ut dictum nisi, egestas sagittis nisi. Vivamus eu arcu nisi. Donec ullamcorper, ipsum vitae elementum auctor, neque turpis consectetur velit, eget cursus erat quam ac augue.",
    "Aenean ullamcorper urna tortor, ut elementum felis volutpat faucibus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Proin euismod lacus diam, a faucibus dui ultrices in. Nulla sed commodo ex, eget ullamcorper dui. Sed gravida placerat condimentum. Etiam tincidunt sit amet quam sed aliquam. Sed ac sem non neque molestie dapibus a at elit. Maecenas lacinia fermentum lacus vel hendrerit. Vivamus arcu urna, consectetur sit amet pellentesque quis, fermentum a orci. Praesent et sapien a massa viverra ornare sed id dolor. Integer quis fermentum turpis. Aliquam tempus, libero vitae tincidunt consequat, purus sapien convallis magna, consectetur bibendum metus tellus vitae ipsum. Vestibulum tristique sapien vitae lectus dictum placerat. Lorem ipsum dolor sit amet, consectetur adipiscing elit.",
    "Nullam convallis ultricies fringilla. Aenean congue at est eu varius. Donec suscipit sapien efficitur, pulvinar quam in, tristique ex. Praesent placerat ullamcorper justo vitae tempor. Donec scelerisque nibh massa, eu rhoncus lacus gravida nec. Sed at aliquet justo. Nunc ac auctor lorem, sed hendrerit ipsum. Aenean egestas tellus ac eros cursus dignissim.",
    "In ultricies ante in laoreet tristique. Cras vulputate varius pharetra. Vestibulum convallis, ligula non accumsan porttitor, libero ligula gravida nisi, quis dignissim felis magna quis diam. Curabitur id est eu urna efficitur bibendum. Quisque sit amet quam feugiat magna vulputate consequat. Cras fringilla ante id arcu condimentum, vitae tincidunt urna euismod. Integer a fermentum augue. Phasellus vulputate eu lorem sit amet auctor. Ut eu viverra erat. Praesent tristique, velit mollis porta feugiat, turpis nisl pellentesque sem, ac viverra lorem elit nec lectus. Sed pretium dapibus neque id iaculis. Sed suscipit eros ante, nec condimentum nisi maximus sagittis. Curabitur laoreet ullamcorper libero a aliquet. Proin venenatis purus quis vestibulum faucibus. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.",
    "Vestibulum facilisis, dolor id ullamcorper elementum, turpis tortor vestibulum quam, ut ullamcorper tellus sem ac erat. Morbi gravida augue eget elit euismod, a semper ipsum euismod. Donec augue lorem, euismod commodo dignissim quis, porttitor sed orci. Sed pellentesque magna a mattis sodales. In semper semper varius. Suspendisse ac quam commodo, maximus tellus sed, congue ipsum. Aenean nec porttitor erat. Fusce efficitur bibendum dolor, quis commodo nulla ornare vel. Praesent imperdiet eleifend nulla, eu vestibulum est venenatis vel. Integer placerat nulla id consectetur fringilla. In nec nulla ullamcorper, gravida nisi at, posuere purus. Pellentesque vehicula aliquet ex. Suspendisse pretium sit amet nisl non ullamcorper. Pellentesque vulputate neque ac eros ullamcorper, sit amet tincidunt nunc pretium.",
    "Duis diam dolor, gravida in massa eu, vehicula luctus mauris. Nam non facilisis lectus, ac ornare augue. Sed consectetur mauris quis ultricies mattis. Cras nulla nisi, posuere vitae tellus eget, tristique tincidunt sem. Sed non libero eu mauris congue lacinia sed nec nibh. Vestibulum lobortis sem in ultrices ullamcorper. Duis hendrerit tortor eget massa sollicitudin commodo. Vivamus vitae urna quis leo laoreet lacinia. Vivamus sit amet justo quis neque placerat faucibus. Nam euismod vel massa at consectetur. Ut velit nisi, convallis ac maximus quis, pharetra et augue. Morbi sit amet risus ut dolor maximus efficitur.",
    "Suspendisse sed est id neque pretium sagittis. Ut condimentum fringilla faucibus. Morbi mattis elit eu nisl eleifend, nec luctus eros pellentesque. Maecenas fringilla, nunc nec aliquam molestie, tortor turpis semper lectus, pellentesque aliquet ante ante iaculis sem. Donec fringilla orci vel metus facilisis efficitur. Praesent a purus at nulla sagittis gravida sit amet nec est. Donec neque dui, imperdiet eu pulvinar ut, ultrices id neque. Vestibulum pharetra mauris nec sem dignissim blandit. Maecenas ultricies dictum nisi, non iaculis nisl euismod id. Morbi at augue feugiat, commodo libero quis, mattis lacus. Mauris lectus erat, tincidunt sed iaculis ut, fermentum eu odio. Cras quam arcu, interdum id elementum vel, commodo vitae ipsum. Mauris convallis fermentum nunc eu semper. Suspendisse aliquam justo et dolor interdum, nec blandit leo semper.",
    "Quisque sit amet risus sed neque gravida sollicitudin nec vitae nunc. Curabitur massa magna, commodo sit amet hendrerit a, auctor et magna. Sed in ex lobortis elit ornare pretium in sed ex. Etiam vulputate sodales mi nec interdum. Cras condimentum dui at augue ultrices, in euismod odio pulvinar. Duis turpis tortor, dapibus vitae gravida eu, dignissim in mi. Aliquam facilisis sapien at ligula semper, non bibendum leo consequat. Curabitur lobortis consectetur sem, sed aliquet dui maximus vitae. Vestibulum id metus suscipit, eleifend felis facilisis, congue tellus. Nulla ultrices ultricies purus, eget pulvinar lorem pellentesque sit amet. Nam ultrices, felis eu accumsan fringilla, lorem leo convallis tellus, sit amet vestibulum nibh justo vel mauris. Curabitur in nulla fermentum, aliquam dolor vel, ultrices odio. Sed egestas mauris at magna scelerisque, eu auctor quam rutrum.",
    "Integer consequat lorem maximus elementum pellentesque. Fusce placerat interdum risus a vestibulum. Fusce varius euismod urna, dignissim congue tortor egestas quis. Suspendisse metus nulla, mattis eget aliquet et, eleifend non quam. Nam condimentum ornare nulla a tempor. Maecenas sagittis fermentum fermentum. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia Curae; Suspendisse potenti. In dolor libero, venenatis quis vulputate ac, iaculis non lorem. Sed consequat, risus at aliquet facilisis, purus ligula imperdiet lectus, id efficitur lorem tellus eget justo. Nulla lorem metus, tincidunt et pharetra vitae, aliquam vehicula mauris. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Praesent aliquet luctus rutrum. Nam massa sem, rhoncus at malesuada sed, dapibus et metus."
]

function fillLayers(layers) {
    var count = 0
    var paragraphCount = 0
    for (var i = 0; i < layers.length; ++i) {
        var layer = layers[i];
        if (layer.className() == "MSTextLayer") {
            [layer setStringValue:loremText[paragraphCount]];
            [layer setName:"Lorem Ipsum"];
            count += 1;

            if (paragraphCount < 10)
            {
                paragraphCount += 1;
            } else {
                paragraphCount = 0;
            }
        } else if (layer.className() == "MSLayerGroup") {
            count += fillLayer(layer.layers());
        }
    }
    return count;
}

function onRun(context) {
    var count = fillLayers(context.selection)
    if (count == 0) {
        context.api().alert("Please select some text objects.", "Oops!");
    } else {
        log("Filled: " + count);
    }
}
